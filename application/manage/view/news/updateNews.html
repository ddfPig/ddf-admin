<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>更新门户文章-{$Think.config.web.meta_title}{$Think.config.web.version}</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__STATIC__/admin/css/admin.css"></head>
<body>
<div class="layui-card layui-card-open">
    <div class="layui-card-body">
        <form class="layui-form" lay-filter="news" action="{:url()}">

            <div class="layui-form-item">
                <label class="layui-form-label">栏目</label>
                <div class="layui-input-inline">
                    <select name="news_columnid">
                        <option value="">所属栏目</option>
                        {volist name="category" id="vo"}
                        <option value="{$vo['ID']}" {eq name="info.news_columnid|default=''" value="$vo['ID']"}selected="selected"{/eq}>{$vo.html}{$vo.name}</option>
                        {/volist}
                    </select>
                </div>
                <label class="layui-form-label">作者</label>
                <div class="layui-input-inline">
                    <input type="text" name="news_auto"  class="layui-input" value="{$info.news_auto|default='管理员'}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">标题</label>
                <div class="layui-input-block w500">
                    <input type="text" name="news_title" lay-verify="required" class="layui-input" value="{$info.news_title|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">简短标题</label>
                <div class="layui-input-block w500">
                    <input type="text" name="news_titleshort"  class="layui-input" value="{$info.news_titleshort|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">标签</label>
                <div class="layui-input-block w500">
                    <input type="text" name="news_tag"  class="layui-input" value="{$info.news_tag|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">关键字</label>
                <div class="layui-input-block w500">
                    <input type="text" name="news_key"  class="layui-input" value="{$info.news_key|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">封面</label>
                <div class="layui-input-inline w500">
                    <div class="input-group">
                        <input type="text" style="width:408px;" name="pic" value="{$info.news_img|default=''}" class="layui-input">
                        <button class="layui-btn" id="upload" type="button">上传封面</button>
                        <input type="hidden" name="picID" id="picID" value="">
                        <input type="hidden" name="news_img" id="news_img" value="{$info.news_img|default=''}">
                    </div>
                </div>
                <div class="layui-input-inline w200">
                    <img src="{$info.news_img|default=''}" id="srcimgurl" style="height:60px;float: right;margin-right: 10px">

                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">点击量</label>
                <div class="layui-input-inline">
                    <input type="text" name="news_hits" class="layui-input" value="{$info.news_hits|default=0}">
                </div>
                <label class="layui-form-label">评论数</label>
                <div class="layui-input-inline">
                    <input type="text" name="comment_count" class="layui-input" value="{$info.comment_count|default=0}">
                </div>
                <div class="layui-input-inline">
                    <a class="layui-btn" href="javascript:;" id="btn_rnd" title="随机生成">随机生成</a>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">排序</label>
                <div class="layui-input-inline">
                    <input type="text" name="listorder" lay-verify="number" class="layui-input" value="{$info.listorder|default='0'}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">外链地址</label>
                <div class="layui-input-block">
                    <input type="text" name="news_zaddress" class="layui-input" value="{$info.news_zaddress|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">介绍</label>
                <div class="layui-input-block w500">
                    <textarea name="news_scontent" class="layui-textarea">{$info.news_scontent|default=''}</textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">文章内容</label>
                <div class="layui-input-block">
                    <script type="text/javascript" src="__STATIC__/ueditor/ueditor.config.js"></script>
                    <script type="text/javascript" src="__STATIC__/ueditor/ueditor.all.js"></script>
                    <script id="container" name="news_content" style="width:100%;height:400px;" type="text/plain">{$info.news_content|default=''|raw}</script>
                    <script type="text/javascript">
                    var ue = UE.getEditor('container',{
                        serverUrl :"{:url('Ueditor/Index')}",
                        UEDITOR_HOME_URL:'__STATIC__/ueditor/',
                    });
                    </script>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <input name="id" type="hidden" value="{$info.ID|default=''}" />
                    <button class="layui-btn" lay-submit lay-filter="ajax" type="submit">提交</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript" src="__STATIC__/js/jquery.min.js"></script>
<script type="text/javascript" src="__STATIC__/admin/lib/layui/layui.js"></script>
<script type="text/javascript" src="__STATIC__/admin/js/admin.js"></script>
<script type="text/javascript">
    layui.use(['layer','upload','jquery'], function(){
        var layer = layui.layer;
        var upload = layui.upload;
        var uploadInst = upload.render({
            elem: '#upload',
            url: "{:url('manage/upload/upload')}",
            data: {dir:'news'},
            done: function(data){
                if(data.code){
                    layer.msg(data.message, {icon: 1,shade: 0.3,time: 2000},function(layero, index){
                        $('[name="pic"]').val(data.data.url);
                        $("#srcimgurl").attr('src',data.data.url);
                        $("#picID").val(data.data.ID);
                        $("#news_img").val(data.data.url);
                    });
                }else{
                    layer.msg(data.message, {icon: 0,shade: 0.3});
                }
            },
            error: function(){
                    //请求异常回调
                }
        });
    });
    $("#btn_rnd").click(function(){
        $('[name="comment_count"]').val( rndNum(1,300) );
        $('[name="news_hits"]').val( rndNum(5000,9999) );
    });
</script>
</body>
</html>

